{"version":3,"file":"remix.js","sourceRoot":"","sources":["../../../../src/sourcemaps/tools/remix.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+EAA+E;AAC/E,sDAAwC;AACxC,kDAA0B;AAC1B,2DAA0D;AAC1D,+CAA4C;AAC5C,6CAAqD;AAIrD,qDAAuC;AAEhC,MAAM,8BAA8B,GAAG,KAAK,EACjD,OAAgD,EAChD,aAA4B,EAC5B,EAAE;IACF,KAAK,CAAC,GAAG;SACN,IAAI,CAAC;;mFAEyE,eAAK,CAAC,IAAI,CACzF,iBAAiB,CAClB,yBAAyB,CAAC,CAAC;IAE5B,MAAM,cAAc,GAAY,MAAM,IAAA,wBAAgB,EACpD,KAAK,CAAC,MAAM,CAAC;QACX,OAAO,EAAE,qDAAqD;QAC9D,OAAO,EAAE;YACP;gBACE,KAAK,EAAE,sBAAsB;gBAC7B,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,8CAA8C;aACrD;YACD;gBACE,KAAK,EAAE,0CAA0C;gBACjD,KAAK,EAAE,KAAK;aACb;SACF;KACF,CAAC,CACH,CAAC;IAEF,MAAM,CAAC,MAAM,CAAC,uBAAuB,EAAE,cAAc,CAAC,CAAC;IAEvD,IAAI,cAAc,EAAE;QAClB,MAAM,IAAA,qBAAS,EAAC,kBAAkB,EAAE,GAAG,EAAE,CAAC,IAAA,6BAAc,EAAC,aAAa,CAAC,CAAC,CAAC;QACzE,KAAK,CAAC,KAAK,CAAC,gDAAgD,CAAC,CAAC;QAC9D,KAAK,CAAC,GAAG,CAAC,IAAI,CACZ,+DAA+D,CAChE,CAAC;KACH;SAAM;QACL,KAAK,CAAC,GAAG,CAAC,IAAI,CACZ,uBAAuB,eAAK,CAAC,IAAI,CAC/B,yBAAyB,CAC1B,wCAAwC,eAAK,CAAC,IAAI,CACjD,0BAA0B,CAC3B,YAAY,CACd,CAAC;QAEF,KAAK,CAAC,GAAG,CAAC,IAAI,CACZ,eAAe,eAAK,CAAC,IAAI,CACvB,0BAA0B,CAC3B,4BAA4B,eAAK,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CACrE,CAAC;QAEF,8FAA8F;QAC9F,sCAAsC;QACtC,OAAO,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;QAEzB,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC;;mCAEgB,eAAK,CAAC,IAAI,CACvC,0BAA0B,CAC3B,SAAS,eAAK,CAAC,IAAI,CAAC,iCAAiC,CAAC;CAC1D,CAAC,CAAC;QAEC,MAAM,IAAA,wBAAgB,EACpB,KAAK,CAAC,MAAM,CAAC;YACX,OAAO,EAAE,yDAAyD;YAClE,OAAO,EAAE,CAAC,EAAE,KAAK,EAAE,gBAAgB,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;YACnD,YAAY,EAAE,IAAI;SACnB,CAAC,CACH,CAAC;KACH;AACH,CAAC,CAAC;AAtEW,QAAA,8BAA8B,kCAsEzC;AAEF,MAAM,WAAW,GAAG,eAAK,CAAC,IAAI,CAAC;;IAE3B,eAAK,CAAC,WAAW,CACjB,gEAAgE,CACjE;;CAEF,CAAC,CAAC","sourcesContent":["// @ts-expect-error - clack is ESM and TS complains about that. It works though\nimport * as clack from '@clack/prompts';\nimport chalk from 'chalk';\nimport { runRemixWizard } from '../../remix/remix-wizard';\nimport { traceStep } from '../../telemetry';\nimport { abortIfCancelled } from '../../utils/clack';\nimport type { WizardOptions } from '../../utils/types';\nimport type { SourceMapUploadToolConfigurationOptions } from './types';\n\nimport * as Sentry from '@sentry/node';\n\nexport const configureRemixSourceMapsUpload = async (\n  options: SourceMapUploadToolConfigurationOptions,\n  wizardOptions: WizardOptions,\n) => {\n  clack.log\n    .info(`Source Maps upload for Remix is configured automatically by default if you run the Sentry Wizard for Remix.\nBut don't worry, we can redirect you to the wizard now!\nIn case you already tried the wizard, we can also show you how to configure your ${chalk.cyan(\n    'remix.config.js',\n  )} file manually instead.`);\n\n  const shouldRedirect: boolean = await abortIfCancelled(\n    clack.select({\n      message: 'Do you want to run the Sentry Wizard for Remix now?',\n      options: [\n        {\n          label: 'Yes, run the wizard!',\n          value: true,\n          hint: 'The wizard can also configure your SDK setup',\n        },\n        {\n          label: 'No, show me how to configure it manually',\n          value: false,\n        },\n      ],\n    }),\n  );\n\n  Sentry.setTag('redirect-remix-wizard', shouldRedirect);\n\n  if (shouldRedirect) {\n    await traceStep('run-remix-wizard', () => runRemixWizard(wizardOptions));\n    clack.intro('Sentry Source Maps Upload Configuration Wizard');\n    clack.log.info(\n      \"Welcome back to the Source Maps wizard - we're almost done ;)\",\n    );\n  } else {\n    clack.log.step(\n      `Build your app with ${chalk.cyan(\n        'remix build --sourcemap',\n      )}, then upload your source maps using ${chalk.cyan(\n        'sentry-upload-sourcemaps',\n      )} cli tool.`,\n    );\n\n    clack.log.step(\n      `You can add ${chalk.cyan(\n        'sentry-upload-sourcemaps',\n      )} to your build script in ${chalk.cyan('package.json')} like this:`,\n    );\n\n    // Intentially logging directly to console here so that the code can be copied/pasted directly\n    // eslint-disable-next-line no-console\n    console.log(codeSnippet);\n\n    clack.log.step(`or run it manually after building your app.\n\nTo see all available options for ${chalk.cyan(\n      'sentry-upload-sourcemaps',\n    )}, run ${chalk.cyan('sentry-upload-sourcemaps --help')}\n`);\n\n    await abortIfCancelled(\n      clack.select({\n        message: 'Did you finish configuring your build and prod scripts?',\n        options: [{ label: 'Yes, continue!', value: true }],\n        initialValue: true,\n      }),\n    );\n  }\n};\n\nconst codeSnippet = chalk.gray(`\n\"scripts\": {\n  ${chalk.greenBright(\n    '\"build\": \"remix build --sourcemap && sentry-upload-sourcemaps\"',\n  )};\n}\n`);\n"]}