{"version":3,"file":"sdk-example.js","sourceRoot":"","sources":["../../../src/remix/sdk-example.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uCAAyB;AACzB,2CAA6B;AAC7B,+EAA+E;AAC/E,6DAAmC;AAEnC;;GAEG;AACI,KAAK,UAAU,iBAAiB,CAAC,OAMvC;IACC,MAAM,UAAU,GAAG,YAAY,CAAC;IAEhC,IAAI,CAAC,EAAE,CAAC,UAAU,CAAC,UAAU,CAAC,EAAE;QAC9B,EAAE,CAAC,SAAS,CAAC,UAAU,EAAE,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC,CAAC;KAC/C;IAED,MAAM,gBAAgB,GAAG,kCACvB,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,IACxB,GAAG,CAAC;IAEJ,IAAI,EAAE,CAAC,UAAU,CAAC,gBAAgB,CAAC,EAAE;QACnC,iBAAK,CAAC,GAAG,CAAC,IAAI,CACZ,uDAAuD,IAAI,CAAC,QAAQ,CAClE,gBAAgB,CACjB,wCAAwC,CAC1C,CAAC;QACF,OAAO;KACR;IAED,MAAM,EAAE,CAAC,QAAQ,CAAC,SAAS,CACzB,gBAAgB,EAChB,4BAA4B,CAAC,OAAO,CAAC,CACtC,CAAC;IAEF,iBAAK,CAAC,GAAG,CAAC,IAAI,CAAC,kCAAkC,gBAAgB,GAAG,CAAC,CAAC;AACxE,CAAC;AAhCD,8CAgCC;AAED,SAAgB,4BAA4B,CAAC,OAM5C;IACC,MAAM,cAAc,GAAG,OAAO,CAAC,UAAU;QACvC,CAAC,CAAC,GAAG,OAAO,CAAC,GAAG,iBAAiB,OAAO,CAAC,OAAO,oBAAoB,OAAO,CAAC,SAAS,EAAE;QACvF,CAAC,CAAC,WAAW,OAAO,CAAC,OAAO,8BAA8B,OAAO,CAAC,SAAS,EAAE,CAAC;IAEhF,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sHAiC6G,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAgKnI,CAAC;AACF,CAAC;AA7MD,oEA6MC","sourcesContent":["import * as fs from 'fs';\nimport * as path from 'path';\n// @ts-expect-error - clack is ESM and TS complains about that. It works though\nimport clack from '@clack/prompts';\n\n/**\n * Creates an example Remix page to test Sentry\n */\nexport async function createExamplePage(options: {\n  selfHosted: boolean;\n  orgSlug: string;\n  projectId: string;\n  url: string;\n  isTS: boolean;\n}) {\n  const routesPath = 'app/routes';\n\n  if (!fs.existsSync(routesPath)) {\n    fs.mkdirSync(routesPath, { recursive: true });\n  }\n\n  const exampleRoutePath = `app/routes/sentry-example-page.${\n    options.isTS ? 'ts' : 'js'\n  }x`;\n\n  if (fs.existsSync(exampleRoutePath)) {\n    clack.log.warn(\n      `It seems like a sentry example page already exists (${path.basename(\n        exampleRoutePath,\n      )}). Skipping creation of example route.`,\n    );\n    return;\n  }\n\n  await fs.promises.writeFile(\n    exampleRoutePath,\n    getSentryExamplePageContents(options),\n  );\n\n  clack.log.info(`Created sentry example page at ${exampleRoutePath}.`);\n}\n\nexport function getSentryExamplePageContents(options: {\n  selfHosted: boolean;\n  orgSlug: string;\n  projectId: string;\n  url: string;\n  isTS?: boolean;\n}) {\n  const issuesPageLink = options.selfHosted\n    ? `${options.url}organizations/${options.orgSlug}/issues/?project=${options.projectId}`\n    : `https://${options.orgSlug}.sentry.io/issues/?project=${options.projectId}`;\n\n  return `import * as Sentry from \"@sentry/remix\";\nimport { useState, useEffect } from \"react\";\n\nexport const meta = () => {\n  return [\n    { title: \"sentry-example-page\" },\n  ];\n}\n\nexport default function SentryExamplePage() {\n  const [hasSentError, setHasSentError] = useState(false);\n  const [isConnected, setIsConnected] = useState(true);\n  \n  useEffect(() => {\n    async function checkConnectivity() {\n      const result = await Sentry.diagnoseSdkConnectivity();\n      setIsConnected(result !== 'sentry-unreachable');\n    }\n    checkConnectivity();\n  }, [setIsConnected]);\n\n  return (\n    <div>\n      <main>\n        <div className=\"flex-spacer\" />\n        <svg height=\"40\" width=\"40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n          <path d=\"M21.85 2.995a3.698 3.698 0 0 1 1.353 1.354l16.303 28.278a3.703 3.703 0 0 1-1.354 5.053 3.694 3.694 0 0 1-1.848.496h-3.828a31.149 31.149 0 0 0 0-3.09h3.815a.61.61 0 0 0 .537-.917L20.523 5.893a.61.61 0 0 0-1.057 0l-3.739 6.494a28.948 28.948 0 0 1 9.63 10.453 28.988 28.988 0 0 1 3.499 13.78v1.542h-9.852v-1.544a19.106 19.106 0 0 0-2.182-8.85 19.08 19.08 0 0 0-6.032-6.829l-1.85 3.208a15.377 15.377 0 0 1 6.382 12.484v1.542H3.696A3.694 3.694 0 0 1 0 34.473c0-.648.17-1.286.494-1.849l2.33-4.074a8.562 8.562 0 0 1 2.689 1.536L3.158 34.17a.611.611 0 0 0 .538.917h8.448a12.481 12.481 0 0 0-6.037-9.09l-1.344-.772 4.908-8.545 1.344.77a22.16 22.16 0 0 1 7.705 7.444 22.193 22.193 0 0 1 3.316 10.193h3.699a25.892 25.892 0 0 0-3.811-12.033 25.856 25.856 0 0 0-9.046-8.796l-1.344-.772 5.269-9.136a3.698 3.698 0 0 1 3.2-1.849c.648 0 1.285.17 1.847.495Z\" fill=\"currentcolor\"/>\n        </svg>\n        <h1>\n          sentry-example-page\n        </h1>\n\n        <p className=\"description\">\n          Click the button below, and view the sample error on the Sentry <a target=\"_blank\" rel=\"noreferrer\" href=\"${issuesPageLink}\">Issues Page</a>. \n          For more details about setting up Sentry, <a target=\"_blank\" rel=\"noreferrer\" href=\"https://docs.sentry.io/platforms/javascript/guides/remix/\">read our docs</a>.\n        </p>\n\n        <button\n          type=\"button\"\n          onClick={async () => {\n            await Sentry.startSpan({\n              name: 'Example Frontend Span',\n              op: 'test'\n            }, async () => {\n              const res = await fetch(\"/api/sentry-example-api\");\n              if (!res.ok) {\n                setHasSentError(true);\n                throw new Error(\"Sentry Example Frontend Error\");\n              }\n            });\n          }}\n        >\n          <span>\n            Throw Sample Error\n          </span>\n        </button>\n\n        {hasSentError ? (\n          <p className=\"success\">\n            Sample error was sent to Sentry.\n          </p>\n        ) : !isConnected ? (\n          <div className=\"connectivity-error\">\n            <p>The Sentry SDK is not able to reach Sentry right now - this may be due to an adblocker. For more information, see <a target=\"_blank\" rel=\"noreferrer\" href=\"https://docs.sentry.io/platforms/javascript/guides/remix/troubleshooting/#the-sdk-is-not-sending-any-data\">the troubleshooting guide</a>.</p>\n          </div>\n        ) : (\n          <div className=\"success_placeholder\" />\n        )}\n\n        <div className=\"flex-spacer\" />\n        <p className=\"description\">\n          Adblockers will prevent errors from being sent to Sentry.\n        </p>\n      </main>\n\n      {/* Not for production use! We're just saving you from having to delete an extra CSS file ;) */}\n      <style dangerouslySetInnerHTML={{ __html: styles }}></style>\n    </div>\n  );\n}\n\nconst styles = \\`\n  main {\n    display: flex;\n    min-height: 100vh;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    gap: 16px;\n    padding: 16px;\n    font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", sans-serif;\n  }\n\n  h1 {\n    padding: 0px 4px;\n    border-radius: 4px;\n    background-color: rgba(24, 20, 35, 0.03);\n    font-family: monospace;\n    font-size: 20px;\n    line-height: 1.2;\n  }\n\n  p {\n    margin: 0;\n    font-size: 20px;\n  }\n\n  a {\n    color: #6341F0;\n    text-decoration: underline;\n    cursor: pointer;\n\n    @media (prefers-color-scheme: dark) {\n      color: #B3A1FF;\n    }\n  }\n\n  button {\n    border-radius: 8px;\n    color: white;\n    cursor: pointer;\n    background-color: #553DB8;\n    border: none;\n    padding: 0;\n    margin-top: 4px;\n\n    & > span {\n      display: inline-block;\n      padding: 12px 16px;\n      border-radius: inherit;\n      font-size: 20px;\n      font-weight: bold;\n      line-height: 1;\n      background-color: #7553FF;\n      border: 1px solid #553DB8;\n      transform: translateY(-4px);\n    }\n\n    &:hover > span {\n      transform: translateY(-8px);\n    }\n\n    &:active > span {\n      transform: translateY(0);\n    }\n  }\n\n  .description {\n    text-align: center;\n    color: #6E6C75;\n    max-width: 500px;\n    line-height: 1.5;\n    font-size: 20px;\n\n    @media (prefers-color-scheme: dark) {\n      color: #A49FB5;\n    }\n  }\n\n  .flex-spacer {\n    flex: 1;\n  }\n\n  .success {\n    padding: 12px 16px;\n    border-radius: 8px;\n    font-size: 20px;\n    line-height: 1;\n    background-color: #00F261;\n    border: 1px solid #00BF4D;\n    color: #181423;\n  }\n\n  .success_placeholder {\n    height: 46px;\n  }\n  \n  .connectivity-error {\n    padding: 12px 16px;\n    background-color: #E50045;\n    border-radius: 8px;\n    width: 500px;\n    color: #FFFFFF;\n    border: 1px solid #A80033;\n    text-align: center;\n    margin: 0;\n  }\n  \n  .connectivity-error a {\n    color: #FFFFFF;\n    text-decoration: underline;\n  }\n\\`;\n`;\n}\n"]}