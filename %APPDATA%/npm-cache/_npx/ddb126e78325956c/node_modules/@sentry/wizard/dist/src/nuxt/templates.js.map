{"version":3,"file":"templates.js","sourceRoot":"","sources":["../../../src/nuxt/templates.ts"],"names":[],"mappings":"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","sourcesContent":["import { getIssueStreamUrl } from '../utils/url';\n\ntype SelectedSentryFeatures = {\n  performance: boolean;\n  replay: boolean;\n};\n\nexport function getDefaultNuxtConfig(): string {\n  return `// https://nuxt.com/docs/api/configuration/nuxt-config\nexport default defineNuxtConfig({\n  compatibilityDate: '2024-04-03',\n  devtools: { enabled: true }\n})\n`;\n}\n\nexport function getNuxtModuleFallbackTemplate(\n  options: {\n    org: string;\n    project: string;\n    url: string;\n    selfHosted: boolean;\n  },\n  shouldTopLevelImport: boolean,\n): string {\n  return `  modules: [\"@sentry/nuxt/module\"],\n  sentry: {\n    sourceMapsUploadOptions: {\n      org: \"${options.org}\",\n      project: \"${options.project}\",${\n    options.selfHosted ? `\\n      url: \"${options.url}\",` : ''\n  }\n    },${\n      shouldTopLevelImport\n        ? `\\n    autoInjectServerSentry: \"top-level-import\",`\n        : ''\n    }\n  },\n  sourcemap: { client: \"hidden\" },`;\n}\n\nexport function getSentryConfigContents(\n  dsn: string,\n  config: 'client' | 'server',\n  selectedFeatures: SelectedSentryFeatures,\n): string {\n  if (config === 'client') {\n    return getSentryClientConfigContents(dsn, selectedFeatures);\n  }\n\n  return getSentryServerConfigContents(dsn, selectedFeatures);\n}\n\nconst featuresConfigMap: Record<keyof SelectedSentryFeatures, string> = {\n  performance: [\n    '  // We recommend adjusting this value in production, or using tracesSampler',\n    '  // for finer control',\n    '  tracesSampleRate: 1.0,',\n  ].join('\\n'),\n  replay: [\n    '  // This sets the sample rate to be 10%. You may want this to be 100% while',\n    '  // in development and sample at a lower rate in production',\n    '  replaysSessionSampleRate: 0.1,',\n    '  ',\n    '  // If the entire session is not sampled, use the below sample rate to sample',\n    '  // sessions when an error occurs.',\n    '  replaysOnErrorSampleRate: 1.0,',\n    '  ',\n    \"  // If you don't want to use Session Replay, just remove the line below:\",\n    '  integrations: [Sentry.replayIntegration()],',\n  ].join('\\n'),\n};\n\nconst featuresMap: Record<\n  'client' | 'server',\n  Array<keyof SelectedSentryFeatures>\n> = {\n  client: ['performance', 'replay'],\n  server: ['performance'],\n};\n\nexport function getConfigBody(\n  dsn: string,\n  variant: 'client' | 'server',\n  selectedFeatures: SelectedSentryFeatures,\n) {\n  return [\n    `dsn: \"${dsn}\",`,\n    Object.entries(selectedFeatures)\n      .map(([feature, activated]: [keyof SelectedSentryFeatures, boolean]) => {\n        return featuresMap[variant].includes(feature) && activated\n          ? featuresConfigMap[feature]\n          : null;\n      })\n      .filter(Boolean)\n      .join('\\n\\n'),\n  ]\n    .filter(Boolean)\n    .join('\\n\\n');\n}\n\nfunction getSentryClientConfigContents(\n  dsn: string,\n  selectedFeatures: SelectedSentryFeatures,\n): string {\n  return `import * as Sentry from \"@sentry/nuxt\";\n\nSentry.init({\n  // If set up, you can use your runtime config here\n  // dsn: useRuntimeConfig().public.sentry.dsn,\n  ${getConfigBody(dsn, 'client', selectedFeatures)}\n  \n  // Setting this option to true will print useful information to the console while you're setting up Sentry.\n  debug: false,\n});\n`;\n}\n\nfunction getSentryServerConfigContents(\n  dsn: string,\n  selectedFeatures: SelectedSentryFeatures,\n): string {\n  return `import * as Sentry from \"@sentry/nuxt\";\n \nSentry.init({\n  ${getConfigBody(dsn, 'server', selectedFeatures)}\n  \n  // Setting this option to true will print useful information to the console while you're setting up Sentry.\n  debug: false,\n});\n`;\n}\n\nexport function getIndexRouteTemplate(): string {\n  return `<!--\nThis is just to verify the sentry-example-page.\nFeel free to delete this file.\n-->\n\n<template></template>`;\n}\n\nexport function getSentryExamplePageTemplate(options: {\n  url: string;\n  org: string;\n  projectId: string;\n}): string {\n  const { url, org, projectId } = options;\n  const issuesPageLink = getIssueStreamUrl({ url, orgSlug: org, projectId });\n\n  return `<!--\nThis is just a very simple page with a button to throw an example error.\nFeel free to delete this file.\n-->\n\n<script setup>\n  import * as Sentry from '@sentry/nuxt';\n  import { useFetch} from '#imports'\n\n  const hasSentError = ref(false);\n  const isConnected = ref(true);\n  \n  onMounted(async () => {\n    try {\n      const result = await Sentry.diagnoseSdkConnectivity();\n      isConnected.value = result !== 'sentry-unreachable';\n    } catch (error) {\n      isConnected.value = false;\n    }\n  });\n  \n  function getSentryData() {\n    Sentry.startSpan(\n      {\n        name: 'Example Frontend Span',\n        op: 'test'\n      },\n      async () => {\n        const { error } = await useFetch('/api/sentry-example-api');\n        if (error.value) {\n          hasSentError.value = true;\n          throw new Error('Sentry Example Frontend Error');\n        }\n      }\n    )\n  }\n</script>\n\n<template>\n  <title>Sentry Onboarding</title>\n  <div>\n    <main>\n      <div class=\"flex-spacer\" />\n      <svg height=\"40\" width=\"40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n        <path d=\"M21.85 2.995a3.698 3.698 0 0 1 1.353 1.354l16.303 28.278a3.703 3.703 0 0 1-1.354 5.053 3.694 3.694 0 0 1-1.848.496h-3.828a31.149 31.149 0 0 0 0-3.09h3.815a.61.61 0 0 0 .537-.917L20.523 5.893a.61.61 0 0 0-1.057 0l-3.739 6.494a28.948 28.948 0 0 1 9.63 10.453 28.988 28.988 0 0 1 3.499 13.78v1.542h-9.852v-1.544a19.106 19.106 0 0 0-2.182-8.85 19.08 19.08 0 0 0-6.032-6.829l-1.85 3.208a15.377 15.377 0 0 1 6.382 12.484v1.542H3.696A3.694 3.694 0 0 1 0 34.473c0-.648.17-1.286.494-1.849l2.33-4.074a8.562 8.562 0 0 1 2.689 1.536L3.158 34.17a.611.611 0 0 0 .538.917h8.448a12.481 12.481 0 0 0-6.037-9.09l-1.344-.772 4.908-8.545 1.344.77a22.16 22.16 0 0 1 7.705 7.444 22.193 22.193 0 0 1 3.316 10.193h3.699a25.892 25.892 0 0 0-3.811-12.033 25.856 25.856 0 0 0-9.046-8.796l-1.344-.772 5.269-9.136a3.698 3.698 0 0 1 3.2-1.849c.648 0 1.285.17 1.847.495Z\" fill=\"currentcolor\"/>\n      </svg>\n      <h1>\n        sentry-example-page\n      </h1>\n\n      <p class=\"description\">\n        Click the button below, and view the sample error on the Sentry <a target=\"_blank\" href=\"${issuesPageLink}\">Issues Page</a>. \n        For more details about setting up Sentry, <a target=\"_blank\" href=\"https://docs.sentry.io/platforms/javascript/guides/nuxt/\">read our docs</a>.\n      </p>\n\n      <button\n        type=\"button\"\n        @click=\"getSentryData\"\n      >\n        <span>\n          Throw Sample Error\n        </span>\n      </button>\n\n      <p v-if=\"hasSentError\" class=\"success\">\n        Sample error was sent to Sentry.\n      </p>\n      <div v-else-if=\"!isConnected\" class=\"connectivity-error\">\n        <p>The Sentry SDK is not able to reach Sentry right now - this may be due to an adblocker. For more information, see <a target=\"_blank\" href=\"https://docs.sentry.io/platforms/javascript/guides/nuxt/troubleshooting/#the-sdk-is-not-sending-any-data\">the troubleshooting guide</a>.</p>\n      </div>\n      <div v-else class=\"success_placeholder\" />\n\n      <div class=\"flex-spacer\" />\n      <p class=\"description\">\n        Adblockers will prevent errors from being sent to Sentry.\n      </p>\n    </main>\n  </div>\n</template>\n\n<style scoped>\n  :global(body) {\n    margin: 0;\n\n    @media (prefers-color-scheme: dark) {\n      color: #ededed;\n      background-color: #0a0a0a;\n    }\n  }\n\n  main {\n    display: flex;\n    min-height: 100vh;\n    box-sizing: border-box;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    gap: 16px;\n    padding: 16px;\n    font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", sans-serif;\n  }\n\n  h1 {\n    padding: 0px 4px;\n    margin: 0;\n    border-radius: 4px;\n    background-color: rgba(24, 20, 35, 0.03);\n    font-family: monospace;\n    font-size: 20px;\n    line-height: 1.2;\n  }\n\n  p {\n    margin: 0;\n    font-size: 20px;\n  }\n\n  a {\n    color: #6341F0;\n    text-decoration: underline;\n    cursor: pointer;\n\n    @media (prefers-color-scheme: dark) {\n      color: #B3A1FF;\n    }\n  }\n\n  button {\n    border-radius: 8px;\n    color: white;\n    cursor: pointer;\n    background-color: #553DB8;\n    border: none;\n    padding: 0;\n    margin-top: 4px;\n\n    & > span {\n      display: inline-block;\n      padding: 12px 16px;\n      border-radius: inherit;\n      font-size: 20px;\n      font-weight: bold;\n      line-height: 1;\n      background-color: #7553FF;\n      border: 1px solid #553DB8;\n      transform: translateY(-4px);\n    }\n\n    &:hover > span {\n      transform: translateY(-8px);\n    }\n\n    &:active > span {\n      transform: translateY(0); \n    }\n  }\n\n  .description {\n    text-align: center;\n    color: #6E6C75;\n    max-width: 500px;\n    line-height: 1.5;\n    font-size: 20px;\n\n    @media (prefers-color-scheme: dark) {\n      color: #A49FB5;\n    }\n  }\n\n  .flex-spacer {\n    flex: 1;\n  }\n\n  .success {\n    padding: 12px 16px;\n    border-radius: 8px;\n    font-size: 20px;\n    line-height: 1;\n    background-color: #00F261;\n    border: 1px solid #00BF4D;\n    color: #181423;\n  }\n\n  .success_placeholder {\n    height: 46px;\n  }\n  \n  .connectivity-error {\n    padding: 12px 16px;\n    background-color: #E50045;\n    border-radius: 8px;\n    width: 500px;\n    color: #FFFFFF;\n    border: 1px solid #A80033;\n    text-align: center;\n    margin: 0;\n  }\n  \n  .connectivity-error a {\n    color: #FFFFFF;\n    text-decoration: underline;\n  }\n</style>\n\n`;\n}\n\nexport function getSentryExampleApiTemplate() {\n  return `// This is just a very simple API route that throws an example error.\n// Feel free to delete this file.\nimport { defineEventHandler } from '#imports';\n\nexport default defineEventHandler(() => {\n  throw new Error(\"Sentry Example API Route Error\");\n});\n`;\n}\n\nexport function getSentryErrorButtonTemplate() {\n  return `<!--\nThis is just a very simple component that throws an example error.\nFeel free to delete this file.\n-->\n\n<script setup>\n  import * as Sentry from '@sentry/nuxt';\n\n  const hasSentError = ref(false);\n  \n  const throwError = () => {\n    Sentry.startSpan(\n      {\n        name: 'Example Frontend Span',\n        op: 'test'\n      },\n      () => {\n        hasSentError.value = true;\n        throw new Error('Sentry Example Error');\n      }\n    )\n  };\n</script>\n\n<template>\n  <div v-if=\"hasSentError\" class=\"success\">\n    Sample error was sent to Sentry.\n  </div>\n  <button v-else @click=\"throwError\">\n    <span>Throw Sample Error</span>\n  </button>\n</template>\n\n<style scoped>\n  button {\n    border-radius: 8px;\n    color: white;\n    cursor: pointer;\n    background-color: #553DB8;\n    border: none;\n    padding: 0;\n    margin-top: 4px;\n    font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", sans-serif;\n\n    & > span {\n      display: inline-block;\n      padding: 12px 16px;\n      border-radius: inherit;\n      font-size: 20px;\n      font-weight: bold;\n      line-height: 1;\n      background-color: #7553FF;\n      border: 1px solid #553DB8;\n      transform: translateY(-4px);\n    }\n\n    &:hover > span {\n      transform: translateY(-8px);\n    }\n\n    &:active > span {\n      transform: translateY(0);\n    }\n  }\n\n  .success {\n    width: max-content;\n    padding: 12px 16px;\n    border-radius: 8px;\n    font-size: 20px;\n    line-height: 1;\n    background-color: #00F261;\n    border: 1px solid #00BF4D;\n    color: #181423;\n    font-family: system-ui, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", sans-serif;\n  }\n</style>\n`;\n}\n"]}