{"version":3,"file":"expo-env-file.js","sourceRoot":"","sources":["../../../src/react-native/expo-env-file.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+EAA+E;AAC/E,sDAAwC;AACxC,kDAA0B;AAC1B,4CAAoB;AACpB,qDAAuC;AAEvC,+BAAuC;AAEvC,MAAM,mBAAmB,GAAG,YAAY,CAAC;AAElC,KAAK,UAAU,eAAe,CACnC,OAAgC;IAEhC,MAAM,UAAU,GAAG,0CAA0C,OAAO,CAAC,SAAS,IAAI,CAAC;IAEnF,MAAM,KAAK,GAAG,MAAM,IAAA,oBAAc,EAAC,mBAAmB,CAAC,CAAC;IACxD,IAAI,KAAK,EAAE;QACT,KAAK,CAAC,GAAG,CAAC,OAAO,CACf,SAAS,eAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAC1D,CAAC;KACH;SAAM;QACL,KAAK,CAAC,GAAG,CAAC,KAAK,CACb,iBAAiB,eAAK,CAAC,IAAI,CACzB,mBAAmB,CACpB,4DAA4D,CAC9D,CAAC;KACH;IAED,IAAI,CAAC,YAAE,CAAC,UAAU,CAAC,mBAAmB,CAAC,EAAE;QACvC,IAAI;YACF,MAAM,YAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,mBAAmB,EAAE,UAAU,CAAC,CAAC;YAC7D,MAAM,CAAC,MAAM,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;YAC3C,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,eAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;YACjE,OAAO,IAAI,CAAC;SACb;QAAC,OAAO,KAAK,EAAE;YACd,MAAM,CAAC,MAAM,CAAC,gBAAgB,EAAE,aAAa,CAAC,CAAC;YAC/C,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,mBAAmB,eAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;YACvE,OAAO,KAAK,CAAC;SACd;KACF;IAED,MAAM,CAAC,MAAM,CAAC,gBAAgB,EAAE,QAAQ,CAAC,CAAC;IAC1C,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,qBAAqB,eAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;IAExE,IAAI;QACF,MAAM,YAAE,CAAC,QAAQ,CAAC,UAAU,CAAC,mBAAmB,EAAE,UAAU,CAAC,CAAC;QAC9D,MAAM,CAAC,MAAM,CAAC,gBAAgB,EAAE,SAAS,CAAC,CAAC;QAC3C,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,WAAW,eAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;QACjE,OAAO,IAAI,CAAC;KACb;IAAC,OAAO,KAAK,EAAE;QACd,MAAM,CAAC,MAAM,CAAC,gBAAgB,EAAE,cAAc,CAAC,CAAC;QAChD,KAAK,CAAC,GAAG,CAAC,KAAK,CAAC,oBAAoB,eAAK,CAAC,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;QACxE,OAAO,KAAK,CAAC;KACd;AACH,CAAC;AA5CD,0CA4CC","sourcesContent":["// @ts-expect-error - clack is ESM and TS complains about that. It works though\nimport * as clack from '@clack/prompts';\nimport chalk from 'chalk';\nimport fs from 'fs';\nimport * as Sentry from '@sentry/node';\nimport { RNCliSetupConfigContent } from './react-native-wizard';\nimport { addToGitignore } from './git';\n\nconst EXPO_ENV_LOCAL_FILE = '.env.local';\n\nexport async function addExpoEnvLocal(\n  options: RNCliSetupConfigContent,\n): Promise<boolean> {\n  const newContent = `#DO NOT COMMIT THIS\\nSENTRY_AUTH_TOKEN=${options.authToken}\\n`;\n\n  const added = await addToGitignore(EXPO_ENV_LOCAL_FILE);\n  if (added) {\n    clack.log.success(\n      `Added ${chalk.cyan(EXPO_ENV_LOCAL_FILE)} to .gitignore.`,\n    );\n  } else {\n    clack.log.error(\n      `Could not add ${chalk.cyan(\n        EXPO_ENV_LOCAL_FILE,\n      )} to .gitignore, please add it to not commit your auth key.`,\n    );\n  }\n\n  if (!fs.existsSync(EXPO_ENV_LOCAL_FILE)) {\n    try {\n      await fs.promises.writeFile(EXPO_ENV_LOCAL_FILE, newContent);\n      Sentry.setTag('expo-env-local', 'written');\n      clack.log.success(`Written ${chalk.cyan(EXPO_ENV_LOCAL_FILE)}.`);\n      return true;\n    } catch (error) {\n      Sentry.setTag('expo-env-local', 'write-error');\n      clack.log.error(`Unable to write ${chalk.cyan(EXPO_ENV_LOCAL_FILE)}.`);\n      return false;\n    }\n  }\n\n  Sentry.setTag('expo-env-local', 'exists');\n  clack.log.info(`Updating existing ${chalk.cyan(EXPO_ENV_LOCAL_FILE)}.`);\n\n  try {\n    await fs.promises.appendFile(EXPO_ENV_LOCAL_FILE, newContent);\n    Sentry.setTag('expo-env-local', 'updated');\n    clack.log.success(`Updated ${chalk.cyan(EXPO_ENV_LOCAL_FILE)}.`);\n    return true;\n  } catch (error) {\n    Sentry.setTag('expo-env-local', 'update-error');\n    clack.log.error(`Unable to update ${chalk.cyan(EXPO_ENV_LOCAL_FILE)}.`);\n    return false;\n  }\n}\n"]}