{"version":3,"file":"express-server.js","sourceRoot":"","sources":["../../../../src/remix/codemods/express-server.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,uCAGkB;AAClB,uCAAyB;AAEzB,qDAAiD;AAEjD,+GAA+G;AACxG,KAAK,UAAU,qCAAqC;IACzD,MAAM,aAAa,GAAG;QACpB,QAAQ;QACR,cAAc;QACd,YAAY;QACZ,kBAAkB;KACnB,CAAC;IAEF,KAAK,MAAM,QAAQ,IAAI,aAAa,EAAE;QACpC,MAAM,QAAQ,GAAG,IAAA,oBAAQ,EAAC,QAAQ,CAAC,CAAC;QAEpC,IAAI,CAAC,QAAQ,EAAE;YACb,SAAS;SACV;QAED,MAAM,QAAQ,GAAG,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;QAEvC,IAAI,CAAC,QAAQ,CAAC,MAAM,EAAE,EAAE;YACtB,SAAS;SACV;QAED,MAAM,OAAO,GAAG,MAAM,IAAA,mBAAQ,EAAC,QAAQ,CAAC,CAAC;QACzC,MAAM,0BAA0B,GAAG,OAAO,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAC5D,CAAC,GAAG,EAAE,EAAE,CACN,GAAG,CAAC,IAAI,KAAK,oBAAoB;YACjC,GAAG,CAAC,QAAQ,KAAK,sBAAsB,CAC1C,CAAC;QAEF,IAAI,0BAA0B,EAAE;YAC9B,OAAO,QAAQ,CAAC;SACjB;KACF;IAED,OAAO,IAAI,CAAC;AACd,CAAC;AAlCD,sFAkCC","sourcesContent":["import {\n  loadFile,\n  // @ts-expect-error - magicast is ESM and TS complains about that. It works though\n} from 'magicast';\nimport * as fs from 'fs';\n\nimport { findFile } from '../../utils/ast-utils';\n\n// Try to find the Express server implementation that contains `createRequestHandler` from `@remix-run/express`\nexport async function findCustomExpressServerImplementation() {\n  const possiblePaths = [\n    'server',\n    'server/index',\n    'app/server',\n    'app/server/index',\n  ];\n\n  for (const filePath of possiblePaths) {\n    const filename = findFile(filePath);\n\n    if (!filename) {\n      continue;\n    }\n\n    const fileStat = fs.statSync(filename);\n\n    if (!fileStat.isFile()) {\n      continue;\n    }\n\n    const fileMod = await loadFile(filename);\n    const createRequestHandlerImport = fileMod.imports.$items.find(\n      (imp) =>\n        imp.from === '@remix-run/express' &&\n        imp.imported === 'createRequestHandler',\n    );\n\n    if (createRequestHandlerImport) {\n      return filename;\n    }\n  }\n\n  return null;\n}\n"]}