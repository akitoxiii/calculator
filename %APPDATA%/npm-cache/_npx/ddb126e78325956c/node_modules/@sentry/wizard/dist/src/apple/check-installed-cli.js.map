{"version":3,"file":"check-installed-cli.js","sourceRoot":"","sources":["../../../src/apple/check-installed-cli.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,+EAA+E;AAC/E,6DAAmC;AACnC,qDAAuC;AACvC,4CAAyC;AACzC,oDAAsC;AACtC,0CAAuD;AACvD,0CAAuC;AAEhC,KAAK,UAAU,iBAAiB;IACrC,IAAA,aAAK,EAAC,qCAAqC,CAAC,CAAC;IAC7C,MAAM,MAAM,GAAG,IAAI,CAAC,YAAY,EAAE,CAAC;IACnC,MAAM,CAAC,MAAM,CAAC,SAAS,EAAE,MAAM,CAAC,CAAC;IACjC,IAAI,MAAM,EAAE;QACV,2FAA2F;QAC3F,IAAA,aAAK,EAAC,yBAAyB,CAAC,CAAC;QACjC,OAAO;KACR;IAED,IAAA,aAAK,EAAC,wDAAwD,CAAC,CAAC;IAChE,MAAM,gBAAgB,GAAG,MAAM,IAAA,qBAAS,EAAC,mBAAmB,EAAE,GAAG,EAAE,CACjE,IAAA,6BAAqB,GAAE,CACxB,CAAC;IACF,IAAI,gBAAgB,EAAE;QACpB,IAAA,aAAK,EAAC,mCAAmC,CAAC,CAAC;QAC3C,MAAM,IAAI,CAAC,gBAAgB,EAAE,CAAC;QAC9B,MAAM,CAAC,MAAM,CAAC,eAAe,EAAE,IAAI,CAAC,CAAC;KACtC;SAAM;QACL,IAAA,aAAK,EAAC,qCAAqC,CAAC,CAAC;QAC7C,iBAAK,CAAC,GAAG,CAAC,IAAI,CACZ,gKAAgK,CACjK,CAAC;QACF,MAAM,CAAC,MAAM,CAAC,eAAe,EAAE,KAAK,CAAC,CAAC;KACvC;AACH,CAAC;AAzBD,8CAyBC","sourcesContent":["// @ts-expect-error - clack is ESM and TS complains about that. It works though\nimport clack from '@clack/prompts';\nimport * as Sentry from '@sentry/node';\nimport { traceStep } from '../telemetry';\nimport * as bash from '../utils/bash';\nimport { askToInstallSentryCLI } from '../utils/clack';\nimport { debug } from '../utils/debug';\n\nexport async function checkInstalledCLI() {\n  debug(`Checking if sentry-cli is installed`);\n  const hasCli = bash.hasSentryCLI();\n  Sentry.setTag('has-cli', hasCli);\n  if (hasCli) {\n    // If the CLI is installed, we don't need to ask the user to install it and can exit early.\n    debug(`sentry-cli is installed`);\n    return;\n  }\n\n  debug(`sentry-cli is not installed, asking user to install it`);\n  const shouldInstallCLI = await traceStep('Ask for SentryCLI', () =>\n    askToInstallSentryCLI(),\n  );\n  if (shouldInstallCLI) {\n    debug(`User agreed to install sentry-cli`);\n    await bash.installSentryCLI();\n    Sentry.setTag('CLI-Installed', true);\n  } else {\n    debug(`User declined to install sentry-cli`);\n    clack.log.warn(\n      \"Without sentry-cli, you won't be able to upload debug symbols to Sentry. You can install it later by following the instructions at https://docs.sentry.io/cli/\",\n    );\n    Sentry.setTag('CLI-Installed', false);\n  }\n}\n"]}